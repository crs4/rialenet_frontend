(this["webpackJsonptela-frontend"]=this["webpackJsonptela-frontend"]||[]).push([[0],{1510:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(0),s=n.n(r),c=n(30),o=n.n(c),i=(n(679),n(680),n(681),n(24)),l=n.n(i),d=n(140),u=n(20),b=(n(660),n(15)),j=n(91),f=n.n(j),h=n(659),x=n(268),p=Object(h.a)({name:"userTasks",initialState:{user:null,tasks:[],offset:0,limit:10,total:-1,filteredIds:null,studentsProfile:[],isSendingMessage:!1},reducers:{willLogin:function(e,t){return e},willLogout:function(e,t){return e},willGetUserProfile:function(e,t){return e},willLoadTasks:function(e,t){return e},willCreateTask:function(e,t){return e},willCreateTransaction:function(e,t){return e},willLoadStudentsProfile:function(e,t){return e},setFilteredIds:function(e,t){e.filteredIds=Object(x.map)(t.payload,"id")},clearFilter:function(e,t){console.log("in clear filter"),e.filteredIds=null},didGetUserProfile:function(e,t){e.user=t.payload},setIsSendingMessage:function(e,t){e.isSendingMessage=t.payload},setTotal:function(e,t){e.total=t.payload},setOffset:function(e,t){e.offset=t.payload},didLogout:function(e){e.user=null,e.tasks=[],e.isSendingMessage=!1,localStorage.removeItem("passcode")},didLoadTasks:function(e,t){e.tasks=t.payload.tasks,e.offset=t.payload.offset,e.total=t.payload.total},didLoadStudentsProfile:function(e,t){e.studentsProfile=t.payload}}}),O=p.actions,g=p.reducer,m=function(e){return e.userTasks.filteredIds},y=function(e){return e.userTasks.tasks},k=function(e){return e.userTasks.user},v=function(e){return e.userTasks.studentsProfile},T=function(e){return e.userTasks.isSendingMessage},w=function(e){return e.userTasks.limit},C=function(e){return e.userTasks.total},S=function(e){return e.userTasks.offset},I=function(e){return function(t){for(var n=t.userTasks.studentsProfile,a=0;a<n.length;a++)if(n[a].wenet_id==e)return n[a];return null}},_=n(1567),A=n(1532),E=n(1533),F=n(1534),U=n(1535),L=n(1536),N=n(1568),D=n(1569),P=n(1570),M=n(1537),W=function(e){var t=e.className,n=e.section,r=e.showMenu,c=void 0!==r&&r,o=Object(_.a)("frontend",{useSuspense:!1}),i=o.t,l=(o.i18n,void 0!=i(n)?i(n):"Forum"),d=s.a.useState(!1),j=Object(u.a)(d,2),f=j[0],h=j[1],x=Object(b.d)(),p=Object(b.e)(k);return console.log("UserProfile:",p),Object(a.jsxs)(A.a,{style:{marginBottom:"10px"},className:t,color:"primary",light:!0,expand:"md",children:[Object(a.jsxs)(E.a,{className:"text-white font-weight-bold",children:["RIALENET - ",l]}),c&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(F.a,{onClick:function(){return h(!f)}}),Object(a.jsxs)(U.a,{isOpen:f,navbar:!0,children:[Object(a.jsx)(L.a,{className:"mr-auto",navbar:!0}),Object(a.jsx)(L.a,{navbar:!0,children:null!=p&&null!=p.name&&Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(N.a,{nav:!0,inNavbar:!0,children:[Object(a.jsxs)(D.a,{className:"text-white",nav:!0,caret:!0,children:[p.name.first," ",p.name.last]}),Object(a.jsx)(P.a,{right:!0,children:Object(a.jsx)(M.a,{onClick:function(){x(O.willLogout(""))},children:i("logout")})})]})})})]})]})]})},q=n(1538),G=n(1539),Y=n(52),z=n(92),R=n(130),J=n(624),B=function e(){Object(J.a)(this,e)};B.admin=1,B.teacher=2,B.student=3;var H=function(e){var t=e.active,n=e.role,r=Object(_.a)("frontend",{useSuspense:!1}),s=r.t;r.i18n;return console.log("Role in sidebar ->",n,B.teacher,n==B.teacher||n==B.admin),Object(a.jsx)("div",{style:{border:"0px solid #000",width:"240px",position:"absolute",backgroundColor:"#f1f1f1",bottom:0,top:56},children:Object(a.jsxs)(L.a,{vertical:!0,className:"list-unstyled pb-3",children:[(n==B.student||n==B.admin)&&Object(a.jsx)(q.a,{active:"student_dashboard"===t,className:"mb-1",children:Object(a.jsxs)(G.a,{className:"student_dashboard"===t?"text-primary":"text-secondary",style:{textDecoration:"none",fontWeight:"bolder"},tag:R.a,to:"/student_dashboard",children:[Object(a.jsx)(Y.a,{icon:z.a,className:"mr-2"})," ",s("student_area")]})}),(n==B.teacher||n==B.admin)&&Object(a.jsx)(q.a,{active:"teacher_dashboard"===t,className:"mb-1",children:Object(a.jsxs)(G.a,{className:"teacher_dashboard"===t?"text-primary":"text-secondary",style:{textDecoration:"none",fontWeight:"bolder"},tag:R.a,to:"/teacher_dashboard",children:[Object(a.jsx)(Y.a,{icon:z.a,className:"mr-2"})," ",s("teacher_area")]})})]})})},X=function(e){var t=e.children,n=e.className,r=e.fluid,s=void 0!==r&&r;return Object(a.jsx)("div",{className:n,style:{border:"0px solid #000",position:"absolute",backgroundColor:"white",bottom:0,top:56,left:s?0:240,right:0},children:t})},Q=n(1540),V=n(1541),K=n(1542),Z=n(1543),$=(n(719),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1578)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))}),ee=(n(722),n(34)),te=n(625),ne=n(661),ae=n(42),re=n(386),se=n(22),ce=n(36),oe=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/newtask",e.prev=1,e.next=4,fetch("/newtask",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({content:t})});case 4:return n=e.sent,console.log("SAGA2 API WENET newtask response:",n),e.next=8,n.text();case 8:return a=e.sent,console.log("SAGA2 API WENET newtask result:",a),e.abrupt("return",a);case 13:return e.prev=13,e.t0=e.catch(1),console.log("WENET API newtask response error:",e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/newtransaction",e.prev=1,e.next=4,fetch("/newtransaction",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({content:t})});case 4:return n=e.sent,console.log("SAGA2 (API) WENET newtransaction response:",n),e.next=8,n.text();case 8:return a=e.sent,console.log("SAGA2 (API) WENET newtransaction result:",a),e.abrupt("return",a);case 13:return e.prev=13,e.t0=e.catch(1),console.log("WENET newtransaction response error:",e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/logout",e.prev=1,e.next=4,fetch("/logout",{headers:{"Content-Type":"application/json"},method:"GET"});case 4:return t=e.sent,console.log("SAGA2 (API) logout response:",t),e.next=8,t.text();case 8:return n=e.sent,console.log("SAGA2 (API) logout result:",n),e.abrupt("return",n);case 13:return e.prev=13,e.t0=e.catch(1),console.log("WENET logout response error:",e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),de=l.a.mark(pe),ue=l.a.mark(Oe),be=l.a.mark(ge),je=l.a.mark(me),fe=l.a.mark(ye),he=l.a.mark(ke),xe=l.a.mark(ve);function pe(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(se.e)(O.willGetUserProfile.type,ge);case 2:return e.next=4,Object(se.e)(O.willLogout.type,Oe);case 4:return e.next=6,Object(se.e)(O.willLoadTasks.type,ke);case 6:return e.next=8,Object(se.e)(O.willLoadStudentsProfile.type,ve);case 8:return e.next=10,Object(se.e)(O.willCreateTask.type,me);case 10:return e.next=12,Object(se.e)(O.willCreateTransaction.type,ye);case 12:case"end":return e.stop()}}),de)}function Oe(e){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(se.c)(O.didLogout());case 2:return e.next=4,Object(se.b)(le);case 4:return t=e.sent,console.log("Logout result:",t),e.next=8,Object(se.c)(Object(ce.d)("/"));case 8:case"end":return e.stop()}}),ue)}function ge(e){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/userprofile",e.prev=1,e.next=4,Object(se.b)((function(){return fetch("/userprofile").then((function(e){return e.json()})).then((function(e){return e}))}));case 4:return t=e.sent,n=null==t?null:t,e.next=8,Object(se.c)(O.didGetUserProfile(n));case 8:if(null!=n){e.next=11;break}return e.next=11,Object(se.c)(Object(ce.d)("/logout"));case 11:e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(1),e.next=17,Object(se.c)(O.didGetUserProfile(null));case 17:return e.next=19,Object(se.c)(Object(ce.d)("/"));case 19:case"end":return e.stop()}}),be,null,[[1,13]])}function me(e){var t,n;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.next=3,Object(se.c)(O.setIsSendingMessage(!0));case 3:return a.next=5,Object(se.b)(oe,t);case 5:if(null==(n=a.sent)){a.next=14;break}return console.log("SAGA2 willCreateTask result OK. Loading tasks...|",n),a.next=10,Object(se.c)(O.setIsSendingMessage(!1));case 10:return a.next=12,Object(se.c)(O.willLoadTasks());case 12:a.next=17;break;case 14:return console.log("SAGA2 willCreateNewTask error"),a.next=17,Object(se.c)(O.setIsSendingMessage(!1));case 17:case"end":return a.stop()}}),je)}function ye(e){var t,n;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.next=3,Object(se.c)(O.setIsSendingMessage(!0));case 3:return a.next=5,Object(se.b)(ie,t);case 5:if(null==(n=a.sent)){a.next=14;break}return console.log("SAGA2 willCreateTransaction result OK. Loading tasks...|",n),a.next=10,Object(se.c)(O.setIsSendingMessage(!1));case 10:return a.next=12,Object(se.c)(O.willLoadTasks());case 12:a.next=17;break;case 14:return console.log("SAGA2 willCreateTransaction error"),a.next=17,Object(se.c)(O.setIsSendingMessage(!1));case 17:case"end":return a.stop()}}),fe)}function ke(e){var t,n,a,r,s,c,o;return l.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(console.log("SAGA2 called willLoadTasks NEW!"),null!=(t=e.payload)){i.next=6;break}return i.next=5,Object(se.d)(S);case 5:t=i.sent;case 6:return i.next=8,Object(se.d)(w);case 8:return n=i.sent,a="/tasks?offset=".concat(t,"&limit=").concat(n),i.prev=10,i.next=13,Object(se.b)((function(){return fetch(a).then((function(e){return e.json()})).then((function(e){return e}))}));case 13:return r=i.sent,s=null==r?[]:r.tasks,c=null==r?0:r.offset,o=null==r?0:r.total,s.sort((function(e,t){return t._creationTs-e._creationTs})),i.next=20,Object(se.c)(O.didLoadTasks({tasks:s,offset:c,total:o}));case 20:i.next=26;break;case 22:return i.prev=22,i.t0=i.catch(10),i.next=26,Object(se.c)(O.didLoadTasks({tasks:[],offset:0,total:0}));case 26:case"end":return i.stop()}}),he,null,[[10,22]])}function ve(e){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/students",e.prev=1,e.next=4,Object(se.b)((function(){return fetch("/students").then((function(e){return e.json()})).then((function(e){return e}))}));case 4:return t=e.sent,n=null==t?[]:t,e.next=8,Object(se.c)(O.didLoadStudentsProfile(n));case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Object(se.c)(O.didLoadStudentsProfile([]));case 14:case"end":return e.stop()}}),xe,null,[[1,10]])}var Te=l.a.mark(we);function we(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("in root saga"),e.next=3,Object(se.a)([pe()]);case 3:case"end":return e.stop()}}),Te)}var Ce=we,Se=n(134),Ie=Object(ae.a)(),_e=function(e){var t,n=Object(ne.a)(),a=[Object(re.a)(Ie),n],r=[ee.applyMiddleware.apply(void 0,a)],s=te.composeWithDevTools.apply(void 0,r),c=(t=Ie,Object(ee.combineReducers)({router:Object(Se.b)(t),userTasks:g})),o=Object(ee.createStore)(c,e,s);return n.run(Ce),o},Ae=n(27),Ee=n(117),Fe=n(662),Ue=n(621),Le=n(1545),Ne=n(1544),De=n(372),Pe=n(179),Me=n(626);n(1511);De.a.use(Me.a).use(Pe.e).init({ns:["tl","frontend"],defaultNS:"tl",fallbackLng:"it",debug:!0,interpolation:{escapeValue:!1}});var We=De.a,qe=function(e){return Object(a.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"10px"},children:Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[Object(a.jsx)(Ne.a,{style:{cursor:"pointer",marginRight:"10px"},width:"30px",title:"English",onClick:function(){localStorage.setItem("rialenet_language","en-US"),We.changeLanguage("en-US")}}),Object(a.jsx)(Ne.b,{style:{cursor:"pointer",marginRight:"10px"},width:"30px",title:"Italiano",onClick:function(){localStorage.setItem("rialenet_language","it-IT"),We.changeLanguage("it-IT")}})]})})},Ge=function(e){e.name;var t=e.disabled,n=e.children,r=Object(Fe.a)(e,["name","disabled","children"]),s=Object(b.e)(T);return Object(a.jsx)(a.Fragment,{children:s?Object(a.jsxs)(Ue.a,Object(Ee.a)(Object(Ee.a)({disabled:!0},r),{},{children:[n,"  ",Object(a.jsx)(Le.a,{size:"sm",color:"light"})]})):Object(a.jsx)(Ue.a,Object(Ee.a)(Object(Ee.a)({disabled:t},r),{},{children:n}))})},Ye=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t;t.i18n;return Object(a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:Object(a.jsxs)(Q.a,{className:"mb-4",style:{borderColor:"#007bff"},children:[Object(a.jsx)(V.a,{style:{backgroundColor:"#007bff",borderColor:"#007bff",paddingBottom:0,color:"white"},children:Object(a.jsx)(K.a,{style:{textAlign:"center"},children:n("platform_title")})}),Object(a.jsx)(Z.a,{children:Object(a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(a.jsx)(Le.a,{style:{margin:"20px"},color:"primary"})})})]})})},ze=n(1546),Re=n(1547),Je=n(1548),Be=n(1549),He=n(1550),Xe=n(1551),Qe=n(1552),Ve=n(54),Ke={cannotAnswer:"reason",needClarification:"note",notSure:"note",myAnswer:"answer",goToAttachment:"attachment",goToTimelinePosition:"timelineLink",goToTag:"tag",rightAnswer:"message",freeAnnotation:"message"},Ze=["myAnswer","needClarification","cannotAnswer"],$e=["freeAnnotation","goToAttachment","goToTimelinePosition","goToTag","rightAnswer"],et=[{id:"62cd7e373dd5251c7183553e",_creationTs:1657634360,_lastUpdateTs:1657634705,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Protocol",description:"What is the protocol followed by the researcher?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[{taskId:"62cd7e373dd5251c7183553e",label:"needClarification",attributes:{note:"Which protocol are you speaking about?"},actioneerId:"928",messages:[],id:"0",_creationTs:1657634434,_lastUpdateTs:1657634434},{taskId:"62cd7e373dd5251c7183553e",label:"goToAttachment",attributes:{attachment:"protocollo processazione cervelli TEM",transactionID:"0"},actioneerId:"671",messages:[],id:"1",_creationTs:1657634533,_lastUpdateTs:1657634533},{taskId:"62cd7e373dd5251c7183553e",label:"cannotAnswer",attributes:{reason:"Sorry. I have no idea."},actioneerId:"928",messages:[],id:"2",_creationTs:1657634605,_lastUpdateTs:1657634605},{taskId:"62cd7e373dd5251c7183553e",label:"goToTimelinePosition",attributes:{timelineLink:"https://beta.riale.ideab3.it/public/a6563273-863b-4e60-8b05-c6b41b332b42?start_time=1635927135000&active_tab=0",transactionID:"2"},actioneerId:"671",messages:[],id:"3",_creationTs:1657634705,_lastUpdateTs:1657634705}]},{id:"62c3115b925841535833b6cd",_creationTs:1656951131,_lastUpdateTs:1656951131,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Ultimo task",description:"non posso  modificarlo!",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62c3007a925841535833b6cc",_creationTs:1656946811,_lastUpdateTs:1656946811,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Diciasettesima domanda",description:"Altra domanda di test per verificare l'ordinamento dei task",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62c2feac925841535833b6cb",_creationTs:1656946348,_lastUpdateTs:1656946348,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Sedicesima Domanda",description:"domanda di prova",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62c17639925841535833b6c9",_creationTs:1656845881,_lastUpdateTs:1656845881,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"L'architettura del PC",description:"Che cosa \xe8 la ram?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62c06bf9925841535833b6c8",_creationTs:1656777722,_lastUpdateTs:1656777722,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Fiumi d'Italia",description:"Quanto \xe8 lungo il Po?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62bf041f925841535833b6c7",_creationTs:1656685600,_lastUpdateTs:1656950940,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"I nuraghi",description:"A quale periodo storico risalgono i nuraghi della Sardegna?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[{taskId:"62bf041f925841535833b6c7",label:"myAnswer",attributes:{answer:"1800-1200 a.c"},actioneerId:"928",messages:[],id:"0",_creationTs:1656757905,_lastUpdateTs:1656757905},{taskId:"62bf041f925841535833b6c7",label:"freeAnnotation",attributes:{message:"Studia di pi\xf9",transactionID:"0"},actioneerId:"671",messages:[],id:"1",_creationTs:1656950940,_lastUpdateTs:1656950940}]},{id:"62bde874925841535833b6c3",_creationTs:1656612980,_lastUpdateTs:1656684725,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Capitali del mondo",description:"Quale \xe8 la capitale del Brasile?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[{taskId:"62bde874925841535833b6c3",label:"cannotAnswer",attributes:{reason:"Non capisco"},actioneerId:"928",messages:[],id:"0",_creationTs:1656674978,_lastUpdateTs:1656674978},{taskId:"62bde874925841535833b6c3",label:"goToAttachment",attributes:{attachment:"i promessiSposi.pdf",transactionID:"0"},actioneerId:"671",messages:[],id:"1",_creationTs:1656684725,_lastUpdateTs:1656684725}]},{id:"62bdc8fc925841535833b6c2",_creationTs:1656604925,_lastUpdateTs:1656604925,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"Task creato in data 30 giugnp",description:"prova",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[]},{id:"62bc1076925841535833b6bf",_creationTs:1656492150,_lastUpdateTs:1656684902,taskTypeId:"62a87b53925841535833b69d",requesterId:"671",appId:"xUi1mwCJ0X",goal:{name:"I promessi Sposi",description:"Chi \xe8 Don Rodrigo?",keywords:["social interaction","lab"]},norms:[],attributes:{},closeTs:null,communityId:"624703620e5af47df0eed5eb",transactions:[{taskId:"62bc1076925841535833b6bf",label:"needClarification",attributes:{note:"cio\xe8?"},actioneerId:"928",messages:[],id:"0",_creationTs:1656684487,_lastUpdateTs:1656684487},{taskId:"62bc1076925841535833b6bf",label:"goToAttachment",attributes:{attachment:"i promessisposi.pdf",transactionID:"0"},actioneerId:"671",messages:[],id:"1",_creationTs:1656684902,_lastUpdateTs:1656684902}]}].slice(9,10),tt=function(e){var t=e.transaction;console.log("Transaction: (props) ",t);var n=Object(_.a)("frontend",{useSuspense:!1}),s=n.t,c=(n.i18n,Object(r.useState)(null==t?-1:Ze.indexOf(t.label))),o=Object(u.a)(c,2),i=o[0],l=o[1],d=Object(r.useState)(null==t?"":t.attributes[Ke[t.label]]),b=Object(u.a)(d,2),j=b[0],h=b[1],x=function(t,n,r){return Object(a.jsxs)(ze.a,{check:!0,disabled:e.readonly,children:[Object(a.jsx)(Re.a,{disabled:e.readonly,name:t,value:r,onChange:function(t){return function(t){console.log("selected choice:",t.target.value),l(t.target.value),e.onUpdate&&t.target.value>=0&&e.onUpdate(Ze[t.target.value],j)}(t)},checked:i==r,type:"radio"})," ",Object(a.jsx)(Je.a,{check:!0,children:n})]},r)},p=e.readonly?"_done":"",O="selectAnswer".concat(p);return Object(a.jsxs)(a.Fragment,{children:[e.transaction&&Object(a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(a.jsx)(Je.a,{children:Object(a.jsx)("b",{children:f()(1e3*e.transaction._creationTs).format("DD/MM/YYYY - HH:mm")})})}),Object(a.jsxs)(Be.a,{style:e.readonly?{border:"1px solid #00FF11",padding:"10px",margin:"10px"}:{border:"1px solid #FF0000",padding:"10px",margin:"10px"},children:[Object(a.jsx)(Je.a,{children:Object(a.jsx)("b",{children:s(O)})}),Ze.map((function(e,t){return x("studentChoice",s(e),t)})),function(){var t=e.readonly?"_done":"",n="".concat(Ze[i]).concat(t);return i>=0&&Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"studentAnswerText",children:Object(a.jsx)("b",{children:s("comment_on_".concat(n))})}),Object(a.jsx)(Re.a,{disabled:e.readonly,id:"studentAnswerText",name:"text",type:"textarea",onChange:function(t){return function(t){console.log("current text:",t.target.value),h(t.target.value),e.onUpdate&&i>=0&&e.onUpdate(Ze[i],t.target.value)}(t)},value:j})]})})}(),function(){var t=function(){var t=e.teacherFeedback;return e.transaction,null==t?null:(console.log("TF FeedbackTransaction ID:",t),s("student_comment_on_".concat(t.label))+" "+t.attributes[Ke[t.label]])}();return t&&Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"teacherAnswerText",children:Object(a.jsx)("b",{children:s("teacherFeedback")})}),Object(a.jsx)(Re.a,{disabled:e.readonly,id:"teacherAnswerText",name:"text",type:"textarea",value:t})]})})}()]})]})},nt=function(e){var t=Object(r.useState)(!1),n=Object(u.a)(t,2),s=n[0],c=n[1],o=function(){return c(!s)},i=Object(_.a)("frontend",{useSuspense:!1}),l=i.t,d=(i.i18n,Object(b.d)()),j=Object(r.useState)(null),h=Object(u.a)(j,2),x=h[0],p=h[1],g=Object(b.e)(k),m=Object(r.useState)({}),y=Object(u.a)(m,2),v=y[0],T=y[1],w=Object(r.useState)(!1),C=Object(u.a)(w,2),S=C[0],I=C[1],A=Object(r.useState)([]),E=Object(u.a)(A,2),F=E[0],L=E[1],N=Object(r.useState)(!1),D=Object(u.a)(N,2),P=D[0],M=D[1];Object(r.useEffect)((function(){var t=e.task;console.log("Student task:",t);for(var n={},a=!1,r=0;r<t.transactions.length;r++){var s=t.transactions[r].attributes.transactionID;null!=s&&null!=g&&g.id==t.transactions[s].actioneerId&&(n[s]=t.transactions[r],"rightAnswer"==n[s].label&&(a=!0))}var c=q(),o=!0,i=Object.keys(n);console.log("SC: FilteredTransactionLen: task:".concat(t.id),c.length);for(var l=0;l<c.length;l++)if(!i.includes(c[l].id)){o=!1;break}I(o),L(c),T(n),M(a),console.log("SC: setFeedbackTeacherTransactions to->: ",n),console.log("SC: NewTransactionFormVisible",o)}),[e.task]);var W=function(){return null!=x&&null!=x.label},q=function(){if(console.log("SC Transaction: (Task ".concat(e.task.id,"):"),e.task.transactions),null==e.task.transactions)return[];var t=e.task.transactions.filter((function(e){return Ze.includes(e.label)&&null!=g&&g.id==e.actioneerId}));return t.sort((function(e,t){return e._creationTs-t._creationTs})),t},G=function(){e.task.goal.name;var t=e.task.goal.description,n=Object.keys(v).length;return Object(a.jsxs)(a.Fragment,{children:[n>0&&Object(a.jsxs)("div",{style:{padding:"10px",margin:"10px",backgroundColor:"#EEEEEE"},children:[l("question_reproposal"),": ",t]}),Object(a.jsx)(tt,{onUpdate:function(e,t){return p({label:e,message:t})}})]})};return function(){var t=e.task.goal.name,n=e.task.goal.description,r=f()(1e3*e.task._creationTs).format("DD/MM/YYYY - HH:mm");return Object(a.jsxs)(Q.a,{className:"mb-4",style:{padding:"10px",borderColor:"#007bff"},children:[Object(a.jsx)(V.a,{onClick:function(){o()},style:{cursor:"pointer",backgroundColor:"#007bff",borderColor:"#007bff",paddingBottom:0,color:"white"},children:Object(a.jsx)(K.a,{children:Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignContent:"space-between"},children:[S&&!P&&Object(a.jsx)(He.a,{style:{margin:"5px",padding:"5px",color:"white",backgroundColor:F.length>0?"#FF0000":"orange"},children:l(F.length>0?"teacherFeedback":"new_question")}),P&&Object(a.jsx)(He.a,{style:{margin:"5px",padding:"5px",color:"white",backgroundColor:"#00AA00"},children:l("rightAnswer")}),"(",r,") ",t,s?Object(a.jsx)(Ve.d,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){o()}}):Object(a.jsx)(Ve.a,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){o()}})]})})}),Object(a.jsxs)(U.a,{isOpen:s,children:[n&&Object(a.jsx)(Xe.a,{style:{padding:"10px",margin:"10px",backgroundColor:"#EEEEEE"},children:n}),Object(a.jsx)(Z.a,{children:Object(a.jsxs)(Be.a,{children:[(console.log("Transaction: (filtered):",F),F.map((function(e){return Object(a.jsx)(tt,{readonly:!0,transaction:e,teacherFeedback:v[e.id]})}))),S&&!P&&G()]})}),Object(a.jsx)(Qe.a,{children:S&&W()&&Object(a.jsx)("div",{style:{display:"flex",marginTop:"10px",justifyContent:"flex-end"},children:Object(a.jsx)(Ge,{color:"primary",onClick:function(t){!function(){if(W()){var t={taskId:e.task.id,content:{label:x.label,message:x.message}};console.log("SAGA2 request da StudentComponents di willCreateTransaction"),d(O.willCreateTransaction(t))}}()},children:l("send")})})})]})]})}()},at=n(2),rt=n(1562),st=n(271),ct=n(275),ot=n(628),it=n(1553),lt=n(1571),dt=function(e){var t=e.tasks,n=s.a.useState(""),r=Object(u.a)(n,2),c=r[0],o=r[1],i=s.a.useState(null),l=Object(u.a)(i,2),d=l[0],j=l[1],f=Object(b.d)(),h=Object(_.a)("frontend",{useSuspense:!1}),p=h.t;h.i18n;s.a.useEffect((function(){console.log("in constructor");return j(new ot.a({fields:["goal.name","goal.description"],searchOptions:{combineWith:"AND"},extractField:function(e,t){return Array.isArray(e[t])?e[t].map((function(e,t){return"object"==typeof e?Object.values(e).join(" "):e})):t.split(".").reduce((function(e,t){return e&&e[t]}),e)},storeFields:["id","goal.name","goal.description"]})),function(){}}),[]),s.a.useEffect((function(){if(console.log("with tasks: ",Object.values(t)),null!=d){d.addAll(Object.values(t));var e=d.search("onde");console.log("with results: ",e)}return function(){}}),[t,d]);return Object(a.jsx)("div",{style:{width:"100%",border:"0px solid #000",height:50,marginBottom:20},children:Object(a.jsxs)(it.a,{children:[Object(a.jsx)(Re.a,{value:c,onChange:function(e){console.log("in on change with ",e.target.value);var t=e.target.value;if(o(t),""!==t){console.log("in onSUggestionFethRequest",t);var n=d.search(t,{prefix:!0});console.log("with search result: ",t,n);var a=Object(x.filter)(n,(function(e){return console.log("check score: ",e,e.score>0),e.score>0}));console.log("MINISEARCH result: ",n),console.log("scored result: ",a),f(O.setFilteredIds(n))}else f(O.clearFilter(null))},placeholder:p("search_tasks")}),Object(a.jsx)(lt.a,{addonType:"append",children:""==c?Object(a.jsx)(Ue.a,{style:{width:50},color:"primary",children:Object(a.jsx)(Y.a,{icon:z.c,style:{fontSize:20},color:"white"})}):Object(a.jsx)(Ue.a,{style:{width:50},onClick:function(){f(O.clearFilter(null)),o("")},color:"primary",children:Object(a.jsx)(Y.a,{icon:z.d,style:{fontSize:20},color:"white"})})})]})})},ut=function(e){var t=Object(b.e)(k),n=Object(b.e)(y),s=Object(b.e)(S),c=Object(b.e)(w),o=Object(b.e)(C),i=Object(r.useState)(n),l=Object(u.a)(i,2),d=l[0],j=l[1],f=Object(b.e)(m),h=Object(b.d)(),x=Object(_.a)("frontend",{useSuspense:!1}),p=x.t;x.i18n;Object(r.useEffect)((function(){h(O.willLoadTasks(null));var e=setInterval((function(){console.log("WillLoad task for student every ".concat(10," seconds")),h(O.willLoadTasks(null))}),1e4);return function(){return clearInterval(e)}}),[]),Object(r.useEffect)((function(){j(null==f?n:n.filter((function(e){return f.includes(e.id)})))}),[n,f]);var g=function(){return o<0?"(".concat(p("loading"),")"):Object(a.jsxs)("span",{style:{display:"flex",justifyContent:"flex-start"},children:[Object(a.jsx)(Ve.b,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){!function(){if(null!=n){var e=s-c;e<0||h(O.willLoadTasks(e))}}()}}),"".concat(s+1,"-").concat(s+n.length," ").concat(p("of")," ").concat(o),Object(a.jsx)(Ve.c,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){!function(){if(null!=n){var e=s+c;e>=o||h(O.willLoadTasks(e))}}()}})]})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(W,{className:"mb-0 text-white",section:"student_area",showMenu:!0}),Object(a.jsx)(H,{active:"student_dashboard",role:null!=t?t.role_id:null}),Object(a.jsxs)(X,{children:[Object(a.jsxs)(A.a,{style:{marginTop:"10px",marginBottom:"10px"},className:"mb-0 text-white",color:"primary",light:!0,expand:"md",children:[Object(a.jsxs)(E.a,{className:"text-white font-weight-bold",children:[p("answers_and_questions")," ",g()]}),Object(a.jsx)(L.a,{className:"mr-auto",navbar:!0}),Object(a.jsx)(L.a,{navbar:!0,children:Object(a.jsx)(rt.a,{onClick:function(){h(O.willLoadTasks(0))},style:{height:34,marginRight:12,marginTop:6,marginBottom:6,borderWidth:1,borderColor:"white",borderStyle:"solid",borderRadius:4},children:Object(a.jsx)(at.b.Provider,{value:{color:"white",className:"global-class-name"},children:Object(a.jsx)(st.a,{color:"white","data-place":"top","data-for":"studentdashboard","data-tip":p("refresh")})})})}),Object(a.jsx)(ct.a,{id:"studentdashboard"})]}),Object(a.jsx)("div",{style:{margin:"10px"},children:Object(a.jsx)(dt,{tasks:n})}),n&&d&&d.map((function(e,t){return Object(a.jsx)(nt,{task:e},t)}))]})]})},bt=n(1566),jt=n(1558),ft=n(1559),ht=n(1560),xt=n(1561),pt=n(272),Ot=n.n(pt),gt=n(1554),mt=n(1556),yt=n(1557),kt=n(1565),vt=n(1573),Tt=n(1575),wt=n(1576),Ct=n(1563),St=n(1574),It=n(1572),_t=n(1577),At=["cannotAnswer","notSure","needClarification","myAnswer",""],Et=["freeAnnotation","goToAttachment","goToTimelinePosition","goToTag","rightAnswer"],Ft="green",Ut=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,s=(t.i18n,Object(r.useState)(null)),c=Object(u.a)(s,2),o=c[0],i=c[1];return Object(r.useEffect)((function(){i(function(e){for(var t=Object.keys(e),a=At.length,r=t.length,s=[],c=0;c<a;c++){for(var o=[],i=[],l=[],d=0;d<r;d++){var u=e[t[d]].interactionsDetails[At[c]]||0,b=e[t[d]].feedbacksDetails[Et[c]]||0;i.push({x:"".concat(t[d]),y:u,label:" ".concat(n(At[c])," (").concat(u,") "),type:"".concat(At[c])}),l.push({x:"".concat(t[d]),y:b,label:" ".concat(n(Et[c])," (").concat(b,") "),type:"".concat(Et[c])})}o.push(i),o.push(l),s.push(o)}return console.log("Data:",s),s}(e.data))}),[]),o&&Object(a.jsx)(gt.a,{children:Object(a.jsxs)(Q.a,{className:"mb-4",style:{borderColor:"#007bff"},children:[e.title&&Object(a.jsx)(V.a,{style:{borderColor:"#007bff",paddingBottom:0,color:"white"},children:Object(a.jsx)(K.a,{tag:"h6",className:"text-center",children:e.title})}),Object(a.jsx)(Z.a,{children:Object(a.jsxs)(kt.a,{domainPadding:{x:50},containerComponent:Object(a.jsx)(vt.a,{}),children:[Object(a.jsxs)(Tt.a,{offset:20,style:{data:{width:15}},children:[Object(a.jsx)(wt.a,{colorScale:"red",children:o.map((function(e,t){return Object(a.jsx)(Ct.a,{labelComponent:Object(a.jsx)(St.a,{style:{fontSize:"8px"},dy:0,centerOffset:{x:-25}}),data:e[0]},t)}))}),Object(a.jsx)(wt.a,{colorScale:Ft,children:o.map((function(e,t){return Object(a.jsx)(Ct.a,{labelComponent:Object(a.jsx)(St.a,{}),data:e[1]},t)}))})]}),Object(a.jsx)(It.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e)}}),Object(a.jsx)(It.a,{style:{tickLabels:{fontSize:"10px"}},tickFormat:function(t){return"".concat(e.data[t].name,"\n").concat(e.data[t].surname)}})]})}),Object(a.jsx)(Qe.a,{children:Object(a.jsxs)("div",{style:{margin:"10px",display:"flex",justifyContent:"space-between"},children:[Object(a.jsx)(_t.a,{title:"  ".concat(n("teacherFeedback")),centerTitle:!0,gutter:5,rowGutter:5,itemsPerRow:10,orientation:"vertical",style:{labels:{fontSize:18},title:{fontSize:20}},colorScale:Ft,data:Et.filter((function(e){return null!=e&&e.length>0})).map((function(e){return{name:n(e)}}))}),Object(a.jsx)(_t.a,{title:"  ".concat(n("students_answers")),centerTitle:!0,gutter:5,rowGutter:5,orientation:"vertical",style:{labels:{fontSize:18},title:{fontSize:20}},colorScale:"red",data:At.filter((function(e){return null!=e&&e.length>0})).map((function(e){return{name:n(e)}}))})]})})]})})},Lt=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,c=(t.i18n,Object(b.d)(),Object(b.e)(v)),o=Object(r.useState)([]),i=Object(u.a)(o,2),l=i[0],d=i[1];Object(r.useEffect)((function(){for(var t=[],n=e.summary,a=0;a<c.length;a++){var r=Object(Ee.a)({},c[a]);console.log("summary (TT)",e.summary);var s=n[r.wenet_id];null==s?(r.interactions=0,r.feedbacks=0,r.completed=!1,r.interactionsDetails={cannotAnswer:0,notSure:0,needClarification:0,myAnswer:0},r.feedbacksDetails={freeAnnotation:0,goToAttachment:0,goToTimelinePosition:0,goToTag:0,rightAnswer:0}):(r.interactions=s.interactions,r.feedbacks=s.feedbacks,r.completed=s.completed,r.interactionsDetails=s.interactionsDetails,r.feedbacksDetails=s.feedbacksDetails),t.push(r)}d(t),console.log("SUMMARY DATA:",JSON.stringify(t))}),[e.summary]);var j=[{dataField:"name",text:n("name"),sort:!0},{dataField:"surname",text:n("surname"),sort:!0},{dataField:"passcode",text:n("passcode"),sort:!0,hidden:!1},{dataField:"id",text:n("profile"),sort:!0},{dataField:"interactions",text:n("interactions"),sort:!0},{dataField:"feedbacks",text:n("feedbacks"),sort:!0},{dataField:"completed",text:n("completed"),formatter:function(e,t){return console.log("Passo value:",t),Object(a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:t.completed?Object(a.jsx)(He.a,{color:"success",style:{margin:"5px",padding:"10px"},children:" ".concat(n("yes")," ")}):Object(a.jsx)(He.a,{color:"warning",style:{margin:"5px",padding:"10px"},children:" ".concat(n("no")," ")})})},sort:!0}];return s.a.useEffect((function(){return function(){}}),[]),Object(a.jsxs)(gt.a,{fluid:!0,children:[Object(a.jsx)(mt.a,{children:Object(a.jsx)(yt.a,{children:Object(a.jsx)(Ot.a,{bootstrap4:!0,keyField:"passcode",data:l,columns:j})})}),Object(a.jsx)(mt.a,{children:Object(a.jsx)(yt.a,{children:l&&l.length>0&&Object(a.jsx)(Ut,{data:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].wenet_id]=e[n];return console.log("Fake data--\x3e:",t),t}(l)})})})]})},Nt=function(e){var t=e.transaction,n=Object(_.a)("frontend",{useSuspense:!1}),s=n.t,c=(n.i18n,Object(r.useState)(null==t?-1:$e.indexOf(t.label))),o=Object(u.a)(c,2),i=o[0],l=o[1],d=Object(r.useState)(""),j=Object(u.a)(d,2),f=j[0],h=j[1],x=Object(b.d)(),p=function(t,n,r){return Object(a.jsxs)(ze.a,{check:!0,disabled:e.readonly,children:[Object(a.jsx)(Re.a,{disabled:e.readonly,name:t,value:r,onChange:function(e){return g(e)},checked:i==r,type:"radio"})," ",Object(a.jsx)(Je.a,{check:!0,children:n})]},r)},g=function(t){console.log("selected feedback choice:",t.target.value),l(t.target.value),e.onUpdate&&i>=0&&e.onUpdate($e[t.target.value],f)},m=function(t){console.log("current text:",t.target.value),h(t.target.value),e.onUpdate&&i>=0&&e.onUpdate($e[i],t.target.value)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{style:{marginTop:"20px"},children:Object(a.jsx)(Je.a,{children:Object(a.jsx)("b",{children:s("send_feedback_to_student")})})}),$e.map((function(e,t){return p("teacherChoice",s(e),t)})),i>=0&&Object(a.jsxs)(ze.a,{children:[Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"teacherAnswerText",children:Object(a.jsx)("b",{children:s("teacher_comment_on_".concat($e[i]))})}),Object(a.jsx)(Re.a,{disabled:!1,id:"teacherAnswerText",name:"text",type:"textarea",onChange:function(e){m(e)},value:f})]}),Object(a.jsx)("div",{style:{display:"flex",marginTop:"10px",justifyContent:"flex-end"},children:Object(a.jsx)(Ge,{onClick:function(){return function(){if(!(i<0)){var t={taskId:e.transaction.taskId,content:{label:$e[i],message:f,transactionID:e.transaction.id}};console.log("Feedback payload:",t),x(O.willCreateTransaction(t))}}()},color:"primary",children:s("send")})})]})]})},Dt=function(e){var t=e.transaction;console.log("Transaction: (props) ",t);var n=Object(b.e)(I(t&&t.actioneerId)),s=Object(_.a)("frontend",{useSuspense:!1}),c=s.t,o=(s.i18n,Object(r.useState)(null==t?-1:Ze.indexOf(t.label))),i=Object(u.a)(o,2),l=i[0],d=i[1],j=Object(r.useState)(null==t?"":t.attributes[Ke[t.label]]),h=Object(u.a)(j,2),x=h[0],p=(h[1],function(t,n,r){return Object(a.jsxs)(ze.a,{check:!0,disabled:e.readonly,children:[Object(a.jsx)(Re.a,{disabled:e.readonly,name:t,value:r,onChange:function(t){return function(t){console.log("selected choice:",t.target.value),d(t.target.value),e.onUpdate&&l>=0&&e.onUpdate(Ze[l],x)}(t)},checked:l==r,type:"radio"})," ",Object(a.jsx)(Je.a,{check:!0,children:n})]},r)}),O=function(){var t=e.teacherFeedback;e.transaction;return null==t?null:(console.log("TF FeedbackTransaction ID:",t),c("".concat(t.label))+" "+t.attributes[Ke[t.label]])};return Object(a.jsxs)(a.Fragment,{children:[e.transaction&&Object(a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:n?Object(a.jsx)(Je.a,{style:null==e.teacherFeedback?{color:"#FF0000"}:{color:"#000000"},children:Object(a.jsxs)("b",{children:[n.name," "," "," ",n.surname," (".concat(n.id,") ")," - "," ",f()(1e3*e.transaction._creationTs).format("DD/MM/YYYY - HH:mm")]})}):Object(a.jsx)(Je.a,{children:Object(a.jsx)("b",{children:f()(1e3*e.transaction._creationTs).format("DD/MM/YYYY - HH:mm")})})}),Object(a.jsxs)(Be.a,{style:{border:"1px solid #007bff",padding:"10px",margin:"10px"},children:[Object(a.jsx)(Je.a,{children:Object(a.jsx)("b",{children:c("teacher_selectAnswer")})}),Ze.map((function(e,t){return p("studentChoice",c(e),t)})),l>=0&&Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"studentAnswerText",children:Object(a.jsx)("b",{children:c("teacher_comment_on_".concat(Ze[l]))})}),Object(a.jsx)(Re.a,{disabled:!0,id:"studentAnswerText",name:"text",type:"textarea",onChange:function(e){},value:x})]})}),null!=e.teacherFeedback?Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"teacherAnswerText",children:Object(a.jsx)("b",{children:c("teacherFeedback")})}),Object(a.jsx)(Re.a,{disabled:e.readonly,id:"teacherAnswerText",name:"text",type:"textarea",value:O()})]})}):Object(a.jsx)(Nt,{transaction:e.transaction})]})]})},Pt=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,s=(t.i18n,Object(r.useState)("")),c=Object(u.a)(s,2),o=c[0],i=c[1],l=Object(r.useState)(""),d=Object(u.a)(l,2),j=d[0],f=d[1],h=Object(b.d)();return Object(a.jsxs)(Be.a,{children:[Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"teacherTaskTitle",children:Object(a.jsx)("b",{children:n("question_topic")})}),Object(a.jsx)(Re.a,{required:!0,id:"teacherTaskTitle",name:"text",type:"text",onChange:function(e){return function(e){i(e.target.value)}(e)},value:o})]})}),Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{marginTop:"20px"},children:[Object(a.jsx)(Je.a,{for:"teacherTaskDescription",children:Object(a.jsx)("b",{children:n("question_content")})}),Object(a.jsx)(Re.a,{required:!0,id:"teacherTaskDescription",name:"text",type:"textarea",onChange:function(e){return function(e){f(e.target.value)}(e)},value:j})]})}),Object(a.jsx)(ze.a,{children:Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(a.jsx)(Ue.a,{onClick:function(t){e.onClose()},children:"Annulla"}),Object(a.jsx)(Ue.a,{disabled:""==o.trim()||""==j.trim(),color:"primary",onClick:function(t){h(O.willCreateTask({name:o,description:j})),e.onClose()},children:n("send")})]})})]})},Mt=function(e){Object(b.e)(k);var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,s=(t.i18n,Object(r.useState)(!1)),c=Object(u.a)(s,2),o=c[0],i=c[1],l=Object(b.d)(),d=Object(b.e)(y),j=Object(b.e)(S),f=Object(b.e)(w),h=Object(b.e)(C),x=Object(b.e)(m),p=Object(r.useState)(d),g=Object(u.a)(p,2),v=g[0],T=g[1];Object(r.useEffect)((function(){l(O.willLoadTasks(null));var e=setInterval((function(){console.log("WillLoad task for teacher every ".concat(10," seconds")),l(O.willLoadTasks(null))}),1e4);return function(){return clearInterval(e)}}),[]),Object(r.useEffect)((function(){T(null==x?d:d.filter((function(e){return x.includes(e.id)})))}),[d,x]);var I=function(){return h<0?"(".concat(n("loading"),")"):Object(a.jsxs)("span",{style:{display:"flex",justifyContent:"flex-start"},children:[Object(a.jsx)(Ve.b,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){!function(){if(null!=d){var e=j-f;e<0||l(O.willLoadTasks(e))}}()}}),"".concat(j+1,"-").concat(j+d.length," ").concat(n("of")," ").concat(h),Object(a.jsx)(Ve.c,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){!function(){if(null!=d){var e=j+f;e>=h||l(O.willLoadTasks(e))}}()}})]})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(A.a,{style:{marginTop:"10px",marginBottom:"10px"},className:"mb-0 text-white",color:"primary",light:!0,expand:"md",children:[Object(a.jsxs)(E.a,{className:"text-white font-weight-bold",children:[n("answers_and_questions")," ",I()]}),Object(a.jsx)(L.a,{className:"mr-auto",navbar:!0}),Object(a.jsxs)(L.a,{navbar:!0,children:[Object(a.jsxs)(Ue.a,{onClick:function(e){console.log("Click new Question"),i(!0)},style:{height:34,marginRight:12,marginTop:6,marginBottom:6,borderWidth:1,borderColor:"white",borderStyle:"solid",borderRadius:4},color:"primary",children:[Object(a.jsx)(Y.a,{icon:z.b}),n("new_question")]}),Object(a.jsx)(rt.a,{onClick:function(){l(O.willLoadTasks(0))},style:{height:34,marginRight:12,marginTop:6,marginBottom:6,borderWidth:1,borderColor:"white",borderStyle:"solid",borderRadius:4},children:Object(a.jsx)(at.b.Provider,{value:{color:"white",className:"global-class-name"},children:Object(a.jsx)(st.a,{color:"white","data-place":"top","data-for":"teacherdashboard","data-tip":n("refresh")})})})]}),Object(a.jsx)(ct.a,{id:"teacherdashboard"})]}),Object(a.jsx)("div",{style:{margin:"10px"},children:Object(a.jsx)(dt,{tasks:d})}),o&&Object(a.jsxs)(bt.a,{isOpen:o,children:[Object(a.jsx)(jt.a,{children:n("new_question")}),Object(a.jsx)(ft.a,{children:Object(a.jsx)(Pt,{onClose:function(){return i(!1)}})})]}),v&&v.map((function(e,t){return Object(a.jsx)(Wt,{task:e},t)}))]})},Wt=function(e){var t=Object(r.useState)(!1),n=Object(u.a)(t,2),s=n[0],c=n[1],o=function(){return c(!s)},i=Object(_.a)("frontend",{useSuspense:!1}),l=i.t,d=(i.i18n,Object(b.e)(v)),j=Object(r.useState)({}),h=Object(u.a)(j,2),x=h[0],p=h[1],O=Object(r.useState)([]),g=Object(u.a)(O,2),m=g[0],y=g[1],k=Object(r.useState)(0),T=Object(u.a)(k,2),w=T[0],C=T[1],S=Object(r.useState)({}),I=Object(u.a)(S,2),A=I[0],E=I[1],F=Object(r.useState)("0"),N=Object(u.a)(F,2),D=N[0],P=N[1],M=Object(r.useState)("0"),W=Object(u.a)(M,2),Y=W[0],z=W[1];Object(r.useEffect)((function(){var t=e.task;console.log("Student task:",t);for(var n={},a=0;a<t.transactions.length;a++){var r=t.transactions[a].attributes.transactionID;null!=r&&(n[r]=t.transactions[a])}var s=J();y(s),console.log("setFeedbackTeacherTransactions to->: ",n),p(n),C(R(s,n));var c=B();console.log("summary (FR)",JSON.stringify(c)),null!=c&&(E(c.summary),z(c.totCompleted))}),[e.task]);var R=function(e,t){return null==e||e.length<1?0:e.length-Object.keys(t).length},J=function(){if(console.log("Transaction: (Task):",e.task.transactions),null==e.task.transactions)return[];var t=e.task.transactions.filter((function(e){return console.log("Transaction: (Filter):",e),Ze.includes(e.label)}));return t.sort((function(e,t){return e._creationTs-t._creationTs})),t},B=function(){var e={},t=0;console.log("DS: numero delle transazioni:",m.length);for(var n=0;n<m.length;n++){var a=m[n].actioneerId;console.log("DS: transaction StudentWenet ID:",a),null==e[a]&&(e[a]={interactionsDetails:{cannotAnswer:0,notSure:0,needClarification:0,myAnswer:0},feedbacksDetails:{freeAnnotation:0,goToAttachment:0,goToTimelinePosition:0,goToTag:0,rightAnswer:0},interactions:0,feedbacks:0,completed:!1}),e[a].interactions+=1,e[a].interactionsDetails[m[n].label]+=1;var r=x[m[n].id];if(console.log("DS: teacherFeedback for user ".concat(a,":"),JSON.stringify(r)),null!=r){var s="rightAnswer"==r.label;e[a].feedbacks+=1,e[a].feedbacksDetails[r.label]+=1,e[a].completed=e[a].completed||s}e[a].completed&&(t+=1)}return console.log("DS: Summary (F)",JSON.stringify(e)),{summary:e,totCompleted:t}},H=function(){var e=null!=d?d.length:0,t=Y<e?"info":"success",n="".concat(Y," ").concat(l("of")," ").concat(e," ").concat(l("completed"));return Object(a.jsx)(He.a,{color:t,children:n})};return function(){var t=e.task.goal.name,n=e.task.goal.description,r=f()(1e3*e.task._creationTs).format("DD/MM/YYYY - HH:mm");return Object(a.jsxs)(Q.a,{className:"mb-4",style:{padding:"10px",borderColor:"#007bff"},children:[Object(a.jsx)(V.a,{onClick:function(){o()},style:{cursor:"pointer",backgroundColor:"#007bff",borderColor:"#007bff",paddingBottom:0,color:"white"},children:Object(a.jsx)(K.a,{children:Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignContent:"space-between"},children:[Object(a.jsxs)("div",{style:{display:"flex",marginRight:"10px",justifyContent:"flex-start"},children:[H(),w>0&&Object(a.jsxs)(He.a,{style:{margin:"5px",padding:"5px",color:"white",backgroundColor:"#FF0000"},children:["".concat(w," "),l("new_messages_from_students")]})]}),"(".concat(r,")  ").concat(t),s?Object(a.jsx)(Ve.d,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){o()}}):Object(a.jsx)(Ve.a,{size:"1.6em",cursor:"pointer",color:"white",onClick:function(){o()}})]})})}),Object(a.jsxs)(U.a,{isOpen:s,children:[n&&Object(a.jsx)(Xe.a,{style:{padding:"10px",margin:"10px",backgroundColor:"#EEEEEE"},children:n}),Object(a.jsxs)(Z.a,{children:[Object(a.jsxs)(L.a,{tabs:!0,children:[Object(a.jsx)(q.a,{children:Object(a.jsx)(G.a,{style:"0"===D?{cursor:"arrow",fontWeight:"bold",background:"#EEEEEE"}:{cursor:"pointer",fontWeight:"normal"},onClick:function(){P("0")},children:l("interactions_with_students")})}),Object(a.jsx)(q.a,{children:Object(a.jsx)(G.a,{style:"1"===D?{cursor:"arrow",fontWeight:"bold",background:"#EEEEEE"}:{cursor:"pointer",fontWeight:"normal"},onClick:function(){P("1")},children:l("summary")})})]}),Object(a.jsxs)(ht.a,{activeTab:D,children:[Object(a.jsx)(xt.a,{tabId:"0",children:Object(a.jsx)(Be.a,{children:(console.log("Transaction: (filter):",m),m.map((function(e,t){return Object(a.jsx)(Dt,{readonly:!0,transaction:e,teacherFeedback:x[e.id]},t)})))})}),Object(a.jsx)(xt.a,{tabId:"1",children:Object(a.jsx)(Lt,{summary:A})})]})]})]})]})}()},qt=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,r=(t.i18n,Object(b.d)()),c=Object(b.e)(v),o=[{dataField:"name",text:n("name"),sort:!0},{dataField:"surname",text:n("surname"),sort:!0},{dataField:"passcode",text:n("passcode"),sort:!0,hidden:!1},{dataField:"id",text:n("profile"),sort:!0},{dataField:"description",text:n("description"),sort:!1}];return s.a.useEffect((function(){return r(O.willLoadStudentsProfile(null)),function(){}}),[]),Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(Ot.a,{bootstrap4:!0,keyField:"passcode",data:c,columns:o})})},Gt=function(e){var t=Object(b.e)(k),n=Object(r.useState)("0"),s=Object(u.a)(n,2),c=s[0],o=s[1],i=Object(_.a)("frontend",{useSuspense:!1}),l=i.t,d=(i.i18n,Object(b.d)());return Object(r.useEffect)((function(){d(O.willGetUserProfile())}),[]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(W,{className:"mb-0 text-white",section:"teacher_area",showMenu:!0}),Object(a.jsx)(H,{active:"teacher_dashboard",role:null!=t?t.role_id:null}),Object(a.jsxs)(X,{children:[Object(a.jsxs)(L.a,{tabs:!0,children:[Object(a.jsx)(q.a,{children:Object(a.jsx)(G.a,{style:"0"===c?{cursor:"arrow",fontWeight:"bold",background:"#EEEEEE"}:{cursor:"pointer",fontWeight:"normal"},onClick:function(){o("0")},children:l("students_answers")})}),Object(a.jsx)(q.a,{children:Object(a.jsx)(G.a,{style:"1"===c?{cursor:"arrow",fontWeight:"bold",background:"#EEEEEE"}:{cursor:"pointer",fontWeight:"normal"},onClick:function(){o("1")},children:l("students_profile")})})]}),Object(a.jsxs)(ht.a,{activeTab:c,children:[Object(a.jsx)(xt.a,{tabId:"0",children:Object(a.jsx)(Mt,{})}),Object(a.jsx)(xt.a,{tabId:"1",children:Object(a.jsx)(qt,{})})]})]})]})},Yt=function(e){var t=Object(_.a)("frontend",{useSuspense:!1}),n=t.t,s=(t.i18n,Object(r.useState)(null)),c=Object(u.a)(s,2),o=c[0],i=c[1],l=Object(r.useRef)(null),d=Object(Ae.g)();Object(r.useEffect)((function(){null!=d&&(l.current=function(){if(null!=d&&null!=d.search){var e=new URLSearchParams(d.search);if(null!=e)return e.get("mypasscode")}return""}(),null!=l.current&&(console.log("Login location current:",l.current),b(l.current)))}),[d]),Object(r.useEffect)((function(){localStorage.setItem("passcode",o)}),[o]);var b=function(e){var t="abcdefghijklmnopqrstuvwxyz".toUpperCase();try{var n=e.trim().toUpperCase();if(8!=n.length)throw"Invalid passcode len:".concat(n.length);for(var a=0,r=0;r<n.length-1;r++)a+=t.indexOf(n.charAt(r));var s=(a-=t.indexOf(n.charAt(7)))%t.length==0;i(s?n:null),console.log("Login Set passcode to:",n)}catch(c){console.log("Login location error?",c),i(null)}};return Object(a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:Object(a.jsxs)(Q.a,{className:"mb-4",style:{borderColor:"#007bff"},children:[Object(a.jsxs)(V.a,{style:{backgroundColor:"#007bff",borderColor:"#007bff",paddingBottom:0,color:"white"},children:[Object(a.jsx)(K.a,{style:{textAlign:"center"},children:n("platform_title")}),Object(a.jsx)(qe,{})]}),Object(a.jsx)(Z.a,{children:Object(a.jsx)(Re.a,{onChange:function(e){return function(e){console.log("entered:",e.target.value),b(e.target.value)}(e)},type:"text",name:"passcode",defaultValue:o,id:"passcode",placeholder:n("passcode_enter")})}),Object(a.jsx)(Qe.a,{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:o&&Object(a.jsx)("a",{href:"/connect?passcode=".concat(o),children:n("connect_to_wenet")})})]})})},zt=function(){var e=Object(b.e)(k),t=Object(b.d)();return Object(r.useEffect)((function(){t(O.willGetUserProfile(null))}),[]),Object(r.useEffect)((function(){console.log("UserProfile in router:",e),null!=e&&null!=e.message&&(alert(e.message),t(Object(ce.d)("/")))}),[e]),Object(a.jsx)(Se.a,{history:Ie,children:Object(a.jsxs)(Ae.d,{children:[Object(a.jsx)(Ae.b,{path:"/devTasks",children:Object(a.jsx)(Mt,{tasks:et})}),Object(a.jsx)(Ae.b,{path:"/student_dashboard",children:null==e?Object(a.jsx)(Ye,{}):e.role_id==B.student||e.role_id==B.admin?Object(a.jsx)(ut,{}):Object(a.jsx)(Ae.a,{to:"/"})}),Object(a.jsx)(Ae.b,{path:"/teacher_dashboard",children:null==e?Object(a.jsx)(Ye,{}):e.role_id==B.teacher||e.role_id==B.admin?Object(a.jsx)(Gt,{}):Object(a.jsx)(Ae.a,{to:"/"})}),Object(a.jsx)(Ae.b,{path:"/login/:mypasscode",children:Object(a.jsx)(Yt,{})}),Object(a.jsx)(Ae.b,{path:"/",children:Object(a.jsx)(Yt,{})})]})})};function Rt(){return Object(a.jsx)(b.a,{store:_e({}),children:Object(a.jsx)(zt,{})})}var Jt=window.navigator.userLanguage||window.navigator.language;"it-IT"!==(localStorage.getItem("rialenet_language")||Jt)?We.changeLanguage("en-US"):We.changeLanguage("it-IT"),o.a.render(Object(a.jsx)(s.a.Fragment,{children:Object(a.jsx)(Rt,{})}),document.getElementById("root")),$()},679:function(e,t,n){}},[[1510,1,2]]]);
//# sourceMappingURL=main.de07d75c.chunk.js.map